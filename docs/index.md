# Rocket Surgeon's Conventions

This is a library to help facilitate creating portable components and libraries that "automagically" integrate when used with an application that uses the
Microsoft Extensions libraries. `IServiceCollection`, `IHostBuilder` and so on.

## Quick Start:

1. Install `Rocket.Surgery.Conventions.Abstractions` in your library code from nuget
    - This step is optional, the abstractions library has fewer direct dependencies which makes your library lighter.
    - It does include `Microsoft.Extensions.Configuration`, `Microsoft.Extensions.DependencyInjection` and `Microsoft.Extensions.Logging`.
1. Install `Rocket.Surgery.Hosting` in you executable assembly (web app / console app / etc)
1. Update your `Program.cs` to import conventions
    ```c#
    [ImportConventions] // Uses source generation
    public static partial class Program
    {
         public static Task<int> Main(string[] args) => CreateHostBuilder(args).RunCli();
         public static IHostBuilder CreateHostBuilder(string[] args) => Host.CreateDefaultBuilder(args)
            .LaunchWith(RocketBooster.ForConventions(GetConventions)) // GetConventions method is generated by source generation
            //.LaunchWith(RocketBooster.ForDependencyContext(DependencyContext.Default)) // optional can be used where you might be able to use source generation
            .ConfigureRocketSurgery(
                 builder => builder // specific overrides you might want.
            );
    }
    ```
1. Create a convention

    ```c#
    using Rocket.Surgery.Conventions;
    [assembly: Convention(typeof(MyServicesConvention))]

    public class MyServicesConvention : IServiceConvention
    {
        public void Register(IConventionContext context, IConfiguration configuration, IServiceCollection services) {
             // Add your services here
        }
    }
    ```

Each convention that you export using an assembly attribute ( eg. `[assembly: Convention(typeof(MyServicesConvention))]`) will automatically be imported and executed during startup.
